apiVersion: kyverno.io/v2
kind: PolicyException
metadata:
  name: esphome-device-builder
  namespace: kyverno
spec:
  exceptions:
    - policyName: psa-baseline
      ruleNames:
        - baseline
  match:
    any:
      - resources:
          kinds:
            - Pod
            - ReplicaSets
            - Deployment
          selector:
            matchLabels:
              app.kubernetes.io/name: esphome-device-builder
  podSecurity:
    - controlName: Host Namespaces
      images: []
      restrictedField: spec.hostNetwork
      values:
        - "true"
    - controlName: Host Ports
      images:
        - "ghcr.io/home-operations/esphome:*"
