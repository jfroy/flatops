{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  packageRules: [
    // - Don't automerge imager or kubelet; want to review Talos and k8s updates
    {
      matchDatasources: ["docker"],
      matchPackageNames: ["ghcr.io/jfroy/siderolabs/imager", "ghcr.io/siderolabs/kubelet"],
      automerge: false,
    },
    // - Don't automerge gpu-operator; requires custom image build
    {
      matchDatasources: ["helm"],
      matchPackageNames: ["gpu-operator"],
      automerge: false,
    },
    // - Don't automerge postgres, it needs review
    {
      matchDatasources: ["docker"],
      matchPackageNames: ["ghcr.io/cloudnative-pg/postgresql"],
      automerge: false,
    },
    // - Don't automerge Cilium minor releases; they are basically major releases
    {
      matchDatasources: ["docker"],
      matchPackageNames: ["ghcr.io/home-operations/charts-mirror/cilium", "quay.io/cilium/charts/cilium"],
      matchUpdateTypes: ["major", "minor"],
      automerge: false,
    },
    // - Don't automerge Rook-Ceph minor releases; they are basically major releases
    {
      matchDatasources: ["docker"],
      matchPackageNames: ["ghcr.io/rook/rook-ceph", "ghcr.io/rook/rook-ceph-cluster"],
      matchUpdateTypes: ["major", "minor"],
      automerge: false,
    },
    // - Don't automerge Samba; updates are disruptive
    {
      matchDatasources: ["docker"],
      matchPackageNames: ["ghcr.io/jfroy/samba"],
      matchUpdateTypes: ["major", "minor", "patch", "digest"],
      automerge: false,
    },
    // - Automerge digest updates from trusted repos
    {
      matchDatasources: ["docker"],
      matchUpdateTypes: ["digest"],
      matchPackageNames: ["ghcr.io/home-operations**/*", "ghcr.io/jfroy/*"],
      automerge: true,
    },
    // - Packages whose major versions are basically minor or patch releases
    {
      matchDatasources: ["docker"],
      matchUpdateTypes: ["major"],
      matchPackageNames: [
        "ghcr.io/mendhak/http-https-echo",
        "ghcr.io/prometheus-community/charts/kube-prometheus-stack",
        "ghcr.io/prometheus-community/charts/prometheus-operator-crds",
        "ghcr.io/prometheus-community/charts/victoria-metrics-operator-crds",
      ],
      automerge: true,
    },
    // - Packages which use digest releases
    {
      matchDatasources: ["docker"],
      matchUpdateTypes: ["digest"],
      matchPackageNames: [
        "ghcr.io/lklynet/hypermind",
        "ghcr.io/squat/generic-device-plugin",
      ],
      automerge: true,
    },
  ]
}
